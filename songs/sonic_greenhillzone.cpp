//
// Created by Abdulmajid, Olivier NASSER on 21/01/2021.
//

#include "examples.hpp"

Sonic_GreenHillZoneTheme::Sonic_GreenHillZoneTheme() {
    this->setSizeDimensions(ROWS,FRAMES,CHANNELS,fx_per_chan);
    this->setTimeDimensions(CLOCK, SPEED, BASETIME);
}

void Sonic_GreenHillZoneTheme::init() {
    //Track::init();
    auto **instruments_bank = new C0deTracker::Instrument *[INSTRUMENTS];
    instruments_bank[HITHAT] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::WHITENOISE, 0.00077f, C0deTracker::ADSR(50.f, 18.f, 0.0f, 0.f)), .55f);
    instruments_bank[SNARE] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::WHITENOISE, 0.0025f, C0deTracker::ADSR(100000.f, 13.f, 0.1f, 4.f)), 1.f);
    instruments_bank[KICK] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::WHITENOISE, 0.1f, C0deTracker::ADSR(10000.f, 50.75f, 0.0f, 0.f)), 0.66f);
    instruments_bank[SQUARE] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::SQUARE, .5f, 0.f, C0deTracker::ADSR(100.0f, 0.f, 0.0f, 100.f)),.1f);
    instruments_bank[BELL] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::SINUS, 1.f, 0.f, C0deTracker::ADSR(500.0f, 5.f, 0.05f, 500.f)),.56f);
    instruments_bank[LEAD] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::SINUS, .085f, 0.0f, C0deTracker::ADSR(5.0f, .7f, 0.f, 5.f)),.17f);
    instruments_bank[ACCOMP] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::SAW, .696969f, 0.0f, C0deTracker::ADSR(100.0f, 0.65f, 0.f, 5.f)),.1f);
    instruments_bank[BASS] = new C0deTracker::Instrument(new C0deTracker::PSG(C0deTracker::WHITENOISE, 0.5f, 0.9f, C0deTracker::ADSR(100.0f, 1.33f, 0.0f, 10.f)), 0.14f);
    this->setInstrumentsBank(instruments_bank, INSTRUMENTS);

    auto *instruments_data_bank = new C0deTracker::Instrument_Data[INSTRUMENTS];
    instruments_data_bank[HITHAT].setData(C0deTracker::WHITENOISE, C0deTracker::ADSR(50.f, 18.f, 0.0f, 0.f), .55f, .0f, .00077f, .0f);
    instruments_data_bank[SNARE].setData(C0deTracker::WHITENOISE, C0deTracker::ADSR(100000.f, 13.f, 0.1f, 4.f), 1.f, .0f, .0025f, .0f);
    instruments_data_bank[KICK].setData(C0deTracker::WHITENOISE, C0deTracker::ADSR(10000.f, 50.75f, 0.0f, 0.f), .66f, .0f, .1f, .0f);
    instruments_data_bank[SQUARE].setData(C0deTracker::SQUARE, C0deTracker::ADSR(100.0f, 0.f, 0.0f, 100.f), .1f, .0f, .5f, .0f);
    instruments_data_bank[BELL].setData(C0deTracker::SINUS, C0deTracker::ADSR(500.0f, 5.f, 0.05f, 500.f), .56f, .0f, 1.0f, .0f);
    instruments_data_bank[LEAD].setData(C0deTracker::SINUS, C0deTracker::ADSR(5.f, .7f, .0f, 5.f), .17f, .0f, .085f, .0f);
    instruments_data_bank[ACCOMP].setData(C0deTracker::SAW, C0deTracker::ADSR(100.f, .65f, .0f, 5.f), .1f, .0f, .696969f, .0f);
    instruments_data_bank[BASS].setData(C0deTracker::WHITENOISE, C0deTracker::ADSR(100.f, 1.33f, .0f, 10.f), .14f, .0f, .5f, .9f);
    this->setInstrumentsDataBank(instruments_data_bank, INSTRUMENTS);

    using C0deTracker::Editor;
    using C0deTracker::Key;
    using namespace C0deTracker::Notes;

    Editor::loadTrackProperties(ROWS, FRAMES, CHANNELS, fx_per_chan); //Load track propreties in the editor
    auto **patterns = Editor::loadEmptyPatterns(); //generate empty patterns for song writing
    auto *pattern_indices = Editor::loadEmptyPatternsIndices(); //generate empty patterns indices for patterns indexing
    Editor::storePatterns(patterns); // store patterns in editor
    Editor::storePatternsIndices(pattern_indices); // store pattern indices in editor

#define VOLM Editor::storeVolume
#define CHANL Editor::storeChannelIndex
#define PATRN Editor::storePatternIndex
#define INSTR Editor::storeInstrumentIndex
#define I Editor::enterInstruction
#define R Editor::release
#define P Editor::enterPatternIndice
#define K Key
#define UI32 uint_fast32_t

    float max = 0.0625f;
    float vF = 1.0f, vE = 0.04962f/max, vD = 0.03943f/max, vC = 0.03131f/max;
    float vB = 0.02487f/max, vA = 0.01974f/max, v9 = 0.01569f/max, v8 = 0.01245f/max;

    UI32 basspitch   =  UI32(0x13400000);
    UI32 leadpitch   =  UI32(0x137C0000);
    UI32 accomppitch =  UI32(0x13840000);

    VOLM(0.3f);
    CHANL(SN3);
    PATRN(0x00);
    INSTR(HITHAT);
    I(0x00, K(D_S,3));
    I(0x08, K(D_S,3));
    I(0x10, K(D_S,3));
    I(0x18, K(D_S,3));
    I(0x1C, K(D_S,3));

    PATRN(0x01);
    I(0x00, K(D_S,3));
    I(0x04, K(D_S,3));
    I(0x08, K(D_S,3));
    I(0x0C, K(D_S,3));
    I(0x10, K(D_S,3));
    I(0x14, K(D_S,3));
    I(0x18, K(D_S,3));
    I(0x1C, K(D_S,3));

    P(SN3, 0x02, 0x01); P(SN3, 0x03, 0x01); P(SN3, 0x04, 0x01); P(SN3, 0x05, 0x01); P(SN3, 0x06, 0x01);
    P(SN3, 0x07, 0x01); P(SN3, 0x08, 0x01); P(SN3, 0x09, 0x01); P(SN3, 0x0A, 0x01); P(SN3, 0x0B, 0x01);
    P(SN3, 0x0C, 0x01); P(SN3, 0x0D, 0x01); P(SN3, 0x0E, 0x01); P(SN3, 0x0F, 0x01); P(SN3, 0x10, 0x01);
    P(SN3, 0x11, 0x01); P(SN3, 0x12, 0x01); P(SN3, 0x13, 0x01); P(SN3, 0x14, 0x01); P(SN3, 0x15, 0x01);
    P(SN3, 0x16, 0x01); P(SN3, 0x17, 0x01); P(SN3, 0x18, 0x01); P(SN3, 0x19, 0x01); P(SN3, 0x1A, 0x01);
    P(SN3, 0x1B, 0x01); P(SN3, 0x1C, 0x01); P(SN3, 0x1D, 0x01); P(SN3, 0x1E, 0x01); P(SN3, 0x1F, 0x01);
    P(SN3, 0x20, 0x01);

    VOLM(vC);
    CHANL(SN1);
    INSTR(SQUARE);
    PATRN(0x01);
    I(0x00, K(C,6)); R(0x02); I(0x04, K(B,5)); R(0x06); I(0x08, K(A,5)); R(0x0A); I(0x0C, K(G,5)); R(0x0E);
    I(0x10, K(C,6)); R(0x12); I(0x14, K(B,5)); R(0x16); I(0x18, K(A,5)); R(0x1A); I(0x1C, K(G,5)); R(0x1E);

    P(SN1, 0x02, 0x01); P(SN1, 0x03, 0x01); P(SN1, 0x04, 0x01); P(SN1, 0x04, 0x01); P(SN1, 0x05, 0x01);
    P(SN1, 0x06, 0x01); P(SN1, 0x07, 0x01); P(SN1, 0x08, 0x01);

    VOLM(vF);
    PATRN(0x02);
    I(0x08, K(E,5)); R(0x0A); I(0x14, K(E,5)); R(0x17);
    PATRN(0x03);
    I(0x08, K(D,5)); R(0x0A); I(0x14, K(D,5)); R(0x17);
    PATRN(0x04);
    I(0x08, K(C,5)); R(0x0A); I(0x14, K(C,5)); R(0x17);
    PATRN(0x05);
    I(0x08, K(B,4)); R(0x0A); I(0x14, K(B,4)); R(0x17);
    PATRN(0x06);
    I(0x00, K(D,5));
    PATRN(0x07);
    I(0x14, K(C,5)); I(0x18, K(D,5)); I(0x1C, K(E,5));
    PATRN(0x09);
    I(0x14, K(C,5)); R(0x17); I(0x18, K(C,5)); I(0x1C, K(E,5));
    PATRN(0x0A);
    I(0x00, K(D_S,5));
    PATRN(0x0B);
    I(0x14, K(C,5)); I(0x18, K(D_S,5)); I(0x1C, K(D,5));
    PATRN(0x0C);
    I(0x00, K(C,4)); R(0x08);
    I(0x0C, K(C,4)); R(0x10);
    I(0x18, K(C,4)); R(0x1C);
    PATRN(0x0D);
    I(0x04, K(C,4)); R(0x0C);
    I(0x10, K(C,4)); R(0x14);
    I(0x18, K(C,4)); R(0x1C);

    P(SN1, 0x09, 0x02); P(SN1, 0x0A, 0x03); P(SN1, 0x0B, 0x02); P(SN1, 0x0C, 0x03); P(SN1, 0x0D, 0x02);
    P(SN1, 0x0E, 0x03); P(SN1, 0x0F, 0x04); P(SN1, 0x10, 0x05); P(SN1, 0x11, 0x02); P(SN1, 0x12, 0x03);
    P(SN1, 0x13, 0x02); P(SN1, 0x14, 0x03); P(SN1, 0x15, 0x02); P(SN1, 0x16, 0x03); P(SN1, 0x17, 0x04);
    P(SN1, 0x18, 0x05); P(SN1, 0x19, 0x06); P(SN1, 0x1A, 0x07); P(SN1, 0x1B, 0x08); P(SN1, 0x1C, 0x09);
    P(SN1, 0x1D, 0x0A); P(SN1, 0x1E, 0x0B); P(SN1, 0x1F, 0x0C); P(SN1, 0x20, 0x0D);

    VOLM(vF);
    CHANL(SN0);
    PATRN(0x01);
    I(0x00, K(E,4)); R(0x04);
    I(0x0C, K(D,4)); R(0x10);
    I(0x18, K(E,4)); R(0x1C);
    PATRN(0x02);
    I(0x04, K(D,4)); R(0x08);
    I(0x10, K(E,4)); R(0x14);
    I(0x18, K(D,4)); R(0x1C);
    PATRN(0x03);
    I(0x00, K(F,4)); R(0x04);
    I(0x0C, K(E,4)); R(0x10);
    I(0x18, K(D,4));
    PATRN(0x04);
    I(0x00, vF);
    I(0x01, vE); I(0x02, vE);
    I(0x03, vD); I(0x04, vD); I(0x05, vD);
    I(0x06, vC); I(0x07, vC); I(0x08, vC);
    I(0x09, vB); I(0x0A, vB); I(0x0B, vB);
    I(0x0C, vA); I(0x0D, vA); I(0x0E, vA);
    I(0x0F, v9);
    I(0x10, v8);
    PATRN(0x05);
    I(0x00, K(D,4)); R(0x04);
    I(0x0C, K(E,4)); R(0x10);
    I(0x18, K(F,4)); R(0x1C);
    PATRN(0x06);
    I(0x00, K(F,4)); R(0x04);
    I(0x0C, K(E,4));
    P(SN0, 6, 5); P(SN0, 7, 6); P(SN0, 8, 4);
    PATRN(0x07);
    R(0x00);
    I(0x08, K(C,5)); R(0x0A);
    I(0x14, K(C,5)); R(0x17);
    PATRN(0x08);
    I(0x08, K(B,4)); R(0x0A);
    I(0x14, K(B,4)); R(0x17);
    P(SN0, 9, 7); P(SN0, 0x0A, 8);
    P(SN0, 0x0B, 7); P(SN0, 0x0C, 8);
    P(SN0, 0x0D, 7); P(SN0, 0x0E, 8);
    PATRN(0x09);
    I(0x08, K(A,4)); R(0x0A);
    I(0x14, K(A,4)); R(0x17);
    PATRN(0x0A);
    I(0x08, K(G,4)); R(0x0A);
    I(0x14, K(G,4)); R(0x17);
    P(SN0, 0x0F, 0x09); P(SN0, 0x10, 0x0A);
    P(SN0, 0x11, 0x07); P(SN0, 0x12, 0x08);
    P(SN0, 0x13, 0x07); P(SN0, 0x14, 0x08);
    P(SN0, 0x15, 0x07); P(SN0, 0x16, 0x08);
    P(SN0, 0x17, 0x09); P(SN0, 0x18, 0x0A);
    VOLM(vC);
    PATRN(0x0B);
    I(0x00, K(A_S,5)); I(0x0C,K(A,5));I(0x18,K(G,5));
    PATRN(0x0C);
    I(0x04, K(F,5));I(0x10,K(E,5));I(0x18,K(D,5));
    PATRN(0x0D);
    I(0x00, K(A,4));I(0x0C,K(B,4));I(0x18,K(C,5));
    PATRN(0x0E);
    I(0x04, K(D,5));I(0x10,K(E,5));I(0x18,K(A,5));
    PATRN(0x0F);
    I(0x00, K(G_S,5));I(0x0C,K(G,5));I(0x18,K(F,5));
    PATRN(0x10);
    I(0x04, K(D_S,5));I(0x10,K(D,5));I(0x18,K(C,5));
    PATRN(0x11);
    I(0x04, K(G,5));I(0x08,K(A,5));I(0x0C,K(G,5));
    I(0x18,K(A,5));
    PATRN(0x12);
    R(0x00);
    I(0x04, K(A,4)); R(0x0C);
    I(0x10, K(A,4)); R(0x14);
    I(0x18, K(A,4));  R(0x1C);
    I(0x1F, UI32(0x0A009000));
    P(SN0, 0x19, 0x0B); P(SN0, 0x1A, 0x0C);
    P(SN0, 0x1B, 0x0D); P(SN0, 0x1C, 0x0E);
    P(SN0, 0x1D, 0x0F); P(SN0, 0x1E, 0x10);
    P(SN0, 0x1F, 0x11); P(SN0, 0x20, 0x12);

    VOLM(0.7f);
    CHANL(FM5);
    INSTR(KICK);
    PATRN(0x00);
    I(0x04, K(C,2));
    I(0x08, SNARE, K(G_S,3), UI32(0x1F000310));
    I(0x0C, K(C,2));
    I(0x10, K(C,2));
    I(0x14, SNARE, K(G_S,3));
    I(0x18, SNARE, K(G_S,3));
    I(0x1C, SNARE, K(G_S,3));
    PATRN(0x01);
    I(0x00, K(C,2));
    I(0x08, SNARE, K(G_S,3), UI32(0x1F000310));
    I(0x0C, K(C,2));
    I(0x14, K(C,2));
    I(0x18, SNARE, K(G_S,3));
    P(FM5, 0x02, 0x01); P(FM5, 0x03, 0x01); P(FM5, 0x04, 0x01); P(FM5, 0x05, 0x01); P(FM5, 0x06, 0x01); P(FM5, 0x07, 0x01);
    PATRN(0x02);
    I(0x00, K(C,2));
    I(0x08, SNARE, K(G_S,3), UI32(0x1F000310));
    I(0x0C, K(C,2));
    I(0x14, SNARE, K(G_S,3));
    I(0x18, SNARE, K(G_S,3));
    I(0x1C, SNARE, K(G_S,3));
    P(FM5, 0x08, 0x02); P(FM5, 0x09, 0x01); P(FM5, 0x0A, 0x01); P(FM5, 0x0B, 0x01); P(FM5, 0x0B, 0x01); P(FM5, 0x0C, 0x01);
    P(FM5, 0x0D, 0x01); P(FM5, 0x0E, 0x01); P(FM5, 0x0F, 0x01); P(FM5, 0x10, 0x02); P(FM5, 0x11, 0x01); P(FM5, 0x12, 0x01);
    P(FM5, 0x13, 0x01); P(FM5, 0x14, 0x01); P(FM5, 0x15, 0x01); P(FM5, 0x16, 0x01); P(FM5, 0x17, 0x01); P(FM5, 0x18, 0x02);
    P(FM5, 0x19, 0x01); P(FM5, 0x1A, 0x01); P(FM5, 0x1B, 0x01); P(FM5, 0x1C, 0x01); P(FM5, 0x1D, 0x01); P(FM5, 0x1E, 0x01);
    P(FM5, 0x1F, 0x01); P(FM5, 0x20, 0x01);

    VOLM(1.0f);
    CHANL(FM2);
    INSTR(BELL);
    PATRN(0x00);
    I(0x00, K(A,5), UI32(0x18FFFFFF)); I(0x02, K(F,5));
    I(0x04, K(A,5)); I(0x06, K(F,5));
    I(0x08, K(B,5)); I(0x0A, K(G,5));
    I(0x0C, K(B,5)); I(0x0E, K(G,5));
    I(0x10, K(C,6)); I(0x12, K(A,5));
    I(0x14, K(C,6)); I(0x16, K(A,5));
    I(0x18, K(D,6)); I(0x1A, K(B,5));
    I(0x1C, K(D,6)); I(0x1E, K(B,5));
    INSTR(ACCOMP);
    PATRN(0x01);
    I(0x00, K(B,4)); R(0x08);
    I(0x0C, K(A,4)); R(0x14);
    I(0x18, K(B,4));
    PATRN(0x02);
    R(0x02);
    I(0x04, K(A,4)); R(0x0C);
    I(0x10, K(B,4)); R(0x14);
    I(0x18, K(A,4));
    PATRN(0x03);
    I(0x00, K(C,5)); R(0x08);
    I(0x0C, K(B,4)); R(0x14);
    I(0x18, K(A,4));
    PATRN(0x04);
    R(0x00);
    PATRN(0x05);
    I(0x00,K(A,4)); R(0x08);
    I(0x0C,K(B,4)); R(0x14);
    I(0x18,K(C,5));
    PATRN(0x06);
    I(0x00,K(C,5)); R(0x08);
    I(0x0C,K(B,4));
    PATRN(0x07);
    I(0x14, K(G,5)); I(0x16, K(A,5)); I(0x18, K(C,6));
    I(0x1C,K(A,5)); R(0x1F);
    PATRN(0x08);
    I(0x14, K(G,5)); I(0x16, K(A,5)); I(0x18, K(C,6));
    I(0x1C,K(E,6)); R(0x1F);
    PATRN(0x09);
    I(0x04, K(C,6)); R(0x07);
    I(0x0C, K(A,5)); I(0x14, K(G,5));
    I(0x18, K(A,5)); I(0x1C, K(C,6));
    R(0x1F);
    PATRN(0x0A);
    I(0x00, K(E,4)); I(0x04, K(C,4)); R(0x07);
    I(0x18, K(E,4)); I(0x1C, K(C,4)); R(0x1F);
    PATRN(0x0B);
    I(0x00, K(D,4)); I(0x04, K(B,3)); R(0x07);
    I(0x14, K(G,5)); I(0x14, K(A,5)); I(0x18, K(C,6));
    I(0x1C, K(A,5)); R(0x1F);
    PATRN(0x0C);
    I(0x00, K(D,4)); I(0x04, K(B,3)); R(0x07);
    I(0x14, K(G,5)); I(0x14, K(A,5)); I(0x18, K(C,6));
    I(0x1C, K(E,6)); R(0x1F);
    PATRN(0x0D);
    I(0x00, K(C,4)); I(0x04, K(A,3)); R(0x07);
    I(0x1C, K(E,6));
    PATRN(0x0E);
    R(0x00); I(0x04, K(C,6)); R(0x08);
    I(0x0C, K(A,5)); R(0x10);
    I(0x14, K(G,5)); I(0x18, K(A,5)); I(0x1C, K(C,6));
    PATRN(0x0F);
    I(0x00, K(F,4)); R(0x08);
    I(0x0C, K(F,4)); R(0x14);
    I(0x18, K(F,4));
    PATRN(0x10);
    R(0x00);
    I(0x04, K(F,4)); R(0x0C);
    I(0x10, K(F,4)); R(0x14);
    I(0x18, K(F,4));
    PATRN(0x11);
    I(0x00, K(E,4)); R(0x08);
    I(0x0C, K(E,4)); R(0x14);
    I(0x18, K(E,4));
    PATRN(0x12);
    R(0x00);
    I(0x04, K(E,4)); R(0x0C);
    I(0x10, K(E,4)); R(0x14);
    I(0x18, K(E,4));
    PATRN(0x13);
    I(0x00, K(D_S,4)); R(0x08);
    I(0x0C, K(D_S,4)); R(0x14);
    I(0x18, K(D_S,4));
    PATRN(0x14);
    R(0x00);
    I(0x04, K(D_S,4)); R(0x0C);
    I(0x10, K(D_S,4)); R(0x14);
    I(0x18, K(D_S,4));
    PATRN(0x15);
    I(0x00, K(A,4)); R(0x08);
    I(0x0C, K(A,4)); R(0x14);
    I(0x18, K(A,4));
    PATRN(0x16);
    I(0x04, K(A,4)); R(0x0C);
    I(0x10, K(A,4)); R(0x14);
    I(0x18, K(A,4));
    P(FM2,0x06,0x05); P(FM2, 0x07, 0x06); P(FM2, 0x08, 0x04); P(FM2, 0x09, 0x04);
    P(FM2, 0x0A, 0x07); P(FM2, 0x0B, 0x04); P(FM2, 0x0C, 0x08); P(FM2, 0x0D, 0x04);
    P(FM2, 0x0E, 0x07); P(FM2, 0x0F, 0x04); P(FM2, 0x10, 0x09); P(FM2, 0x11, 0x0A);
    P(FM2, 0x12, 0x0B); P(FM2, 0x13, 0x0A); P(FM2, 0x14, 0x0C); P(FM2, 0x15, 0x0A);
    P(FM2, 0x16, 0x0B); P(FM2, 0x17, 0x0D); P(FM2, 0x18, 0x0E);
    P(FM2, 0x19, 0x0F); P(FM2, 0x1A, 0x10); P(FM2, 0x1B, 0x11); P(FM2, 0x1C, 0x12);
    P(FM2, 0x1D, 0x13); P(FM2, 0x1E, 0x14); P(FM2, 0x1F, 0x15); P(FM2, 0x20, 0x16);

    VOLM(1.0f);
    CHANL(FM3);
    INSTR(ACCOMP);
    PATRN(0x00);
    I(0x00,  accomppitch);
    PATRN(0x01);
    I(0x00, K(G,4), UI32(0x18000000)); R(0x08);
    I(0x0C, K(F,4)); R(0x14);
    I(0x18, K(G,4));
    PATRN(0x02);
    R(0x02);
    I(0x04, K(F,4)); R(0x0C);
    I(0x10, K(G,4)); R(0x14);
    I(0x18, K(F,4));
    PATRN(0x03);
    I(0x00, K(A,4)); R(0x08);
    I(0x0C, K(G,4)); R(0x14);
    I(0x18, K(F,4));
    PATRN(0x04);
    I(0x00,K(F,4)); R(0x08);
    I(0x0C,K(G,4)); R(0x14);
    I(0x18,K(A,4));
    PATRN(0x05);
    I(0x00,K(A,4)); R(0x08);
    I(0x0C,K(G,4));
    VOLM(vB);
    PATRN(0x06);
    I(0x00, K(E, 4)); R(0x03);
    I(0x04, K(E, 4)); R(0x07);
    I(0x08, K(C, 4)); R(0x0B);
    I(0x0C, K(C, 4)); R(0x0E);
    I(0x10, K(A, 3)); R(0x13);
    I(0x14, K(A, 3)); R(0x17);
    I(0x18, K(F, 3)); R(0x1B);
    I(0x1C, K(F, 3)); R(0x1F);
    PATRN(0x07);
    I(0x00, K(D, 4)); R(0x03);
    I(0x04, K(D, 4)); R(0x07);
    I(0x08, K(B, 3)); R(0x0B);
    I(0x0C, K(B, 3)); R(0x0F);
    I(0x10, K(G, 3)); R(0x13);
    I(0x14, K(G, 3)); R(0x17);
    I(0x18, K(D, 4)); R(0x1B);
    I(0x1C, K(D, 4)); R(0x1F);
    PATRN(0x08);
    I(0x00, K(D, 4)); R(0x03);
    I(0x04, K(D, 4)); R(0x07);
    I(0x08, K(B, 3)); R(0x0B);
    I(0x0C, K(B, 3)); R(0x0F);
    I(0x10, K(G, 3)); R(0x13);
    I(0x14, K(G, 3)); R(0x17);
    I(0x18, K(E, 3)); R(0x1B);
    I(0x1C, K(E, 3)); R(0x1F);
    PATRN(0x09);
    I(0x00, K(C, 4)); R(0x03);
    I(0x04, K(C, 4)); R(0x07);
    I(0x08, K(A, 3)); R(0x0B);
    I(0x0C, K(A, 3)); R(0x0F);
    I(0x10, K(F, 3)); R(0x13);
    I(0x14, K(F, 3)); R(0x17);
    I(0x18, K(D, 3)); R(0x1B);
    I(0x1C, K(D, 3)); R(0x1F);
    PATRN(0x0A);
    I(0x00, K(B, 3)); R(0x03);
    I(0x04, K(B, 3)); R(0x07);
    I(0x08, K(G,5));
    I(0x10, K(A,5));
    I(0x18, K(B,5));
    PATRN(0x0B);
    I(0x00, K(C,6));
    PATRN(0x0C);
    I(0x04, K(D,6)); I(0x0C, K(B,5)); I(0x18, K(G,5));
    PATRN(0x0D);
    I(0x04, K(B,5)); I(0x10, K(G,5)); I(0x18, K(B,5));
    PATRN(0x0E);
    I(0x00, K(A_S,5)); I(0x04, K(F,5)); I(0x08, K(D,6)); I(0x0C, K(F,5));
    I(0x10, K(A_S,5)); I(0x14, K(F,5)); I(0x18, K(D,6)); I(0x1C, K(F,5));
    PATRN(0x0F);
    I(0x00, K(A,5)); I(0x04, K(E,5)); I(0x08, K(C,6)); I(0x0C, K(E,5));
    I(0x10, K(A,5)); I(0x14, K(E,5)); I(0x18, K(C,6)); I(0x1C, K(E,5));
    PATRN(0x10);
    I(0x00, K(G_S,5)); I(0x04, K(D_S,5)); I(0x08, K(C,6)); I(0x0C, K(D_S,5));
    I(0x10, K(G_S,5)); I(0x14, K(D_S,5)); I(0x18, K(C,6)); I(0x1C, K(D_S,5));
    PATRN(0x11);
    I(0x00, K(C,6)); I(0x04, K(A,5)); I(0x08, K(E,6)); I(0x0C, K(A,5));
    I(0x10, K(C,6)); I(0x14, K(A,5)); I(0x18, K(E,6)); I(0x1C, K(A,5));

    P(FM3,0x04,0x00); P(FM3,0x05,0x04); P(FM3,0x06,0x04); P(FM3,0x07,0x05);
    P(FM3,0x08,0x00); P(FM3,0x09,0x06); P(FM3,0x0A,0x07); P(FM3,0x0B,0x06);
    P(FM3,0x0C,0x07); P(FM3,0x0D,0x06); P(FM3,0x0E,0x08); P(FM3,0x0F,0x09);
    P(FM3,0x10,0x0A); P(FM3,0x11,0x0B); P(FM3,0x12,0x0C); P(FM3,0x13,0x0B);
    P(FM3,0x14,0x0D); P(FM3,0x15,0x0B); P(FM3,0x16,0x0C); P(FM3,0x17,0x0B);
    P(FM3,0x18,0x0B); P(FM3,0x19,0x0E); P(FM3,0x1A,0x0E); P(FM3,0x1B,0x0F);
    P(FM3,0x1C,0x0F); P(FM3,0x1D,0x10); P(FM3,0x1E,0x10); P(FM3,0x1F,0x11);
    P(FM3,0x20,0x11);

    VOLM(1.0f);
    CHANL(FM4);
    INSTR(ACCOMP);
    PATRN(0x00);
    I(0x00, accomppitch);
    PATRN(0x01);
    I(0x00, K(E,4), UI32(0x18FFFFFF)); R(0x08);
    I(0x0C, K(D,4)); R(0x14);
    I(0x18, K(E,4));
    PATRN(0x02);
    R(0x02);
    I(0x04, K(D,4)); R(0x0C);
    I(0x10, K(E,4)); R(0x14);
    I(0x18, K(D,4));
    PATRN(0x03);
    I(0x00, K(F,4)); R(0x08);
    I(0x0C, K(E,4)); R(0x14);
    I(0x18, K(D,4));
    PATRN(0x04);
    I(0x00,K(D,4)); R(0x08);
    I(0x0C,K(E,4)); R(0x14);
    I(0x18,K(F,4));
    PATRN(0x05);
    I(0x00,K(F,4)); R(0x08);
    I(0x0C,K(E,4));
    VOLM(vB);
    PATRN(0x06);
    I(0x00, K(E, 4)); R(0x03);
    I(0x04, K(E, 4)); R(0x07);
    I(0x08, K(C, 4)); R(0x0B);
    I(0x0C, K(C, 4)); R(0x0E);
    I(0x10, K(A, 3)); R(0x13);
    I(0x14, K(A, 3)); R(0x17);
    I(0x18, K(F, 3)); R(0x1B);
    I(0x1C, K(F, 3)); R(0x1F);
    PATRN(0x07);
    I(0x00, K(D, 4)); R(0x03);
    I(0x04, K(D, 4)); R(0x07);
    I(0x08, K(B, 3)); R(0x0B);
    I(0x0C, K(B, 3)); R(0x0F);
    I(0x10, K(G, 3)); R(0x13);
    I(0x14, K(G, 3)); R(0x17);
    I(0x18, K(D, 4)); R(0x1B);
    I(0x1C, K(D, 4)); R(0x1F);
    PATRN(0x08);
    I(0x00, K(D, 4)); R(0x03);
    I(0x04, K(D, 4)); R(0x07);
    I(0x08, K(B, 3)); R(0x0B);
    I(0x0C, K(B, 3)); R(0x0F);
    I(0x10, K(G, 3)); R(0x13);
    I(0x14, K(G, 3)); R(0x17);
    I(0x18, K(E, 3)); R(0x1B);
    I(0x1C, K(E, 3)); R(0x1F);
    PATRN(0x09);
    I(0x00, K(C, 4)); R(0x03);
    I(0x04, K(C, 4)); R(0x07);
    I(0x08, K(A, 3)); R(0x0B);
    I(0x0C, K(A, 3)); R(0x0F);
    I(0x10, K(F, 3)); R(0x13);
    I(0x14, K(F, 3)); R(0x17);
    I(0x18, K(D, 3)); R(0x1B);
    I(0x1C, K(D, 3)); R(0x1F);
    PATRN(0x0A);
    I(0x00, K(B, 3)); R(0x03);
    I(0x04, K(B, 3)); R(0x07);
    I(0x08, K(G,5));
    I(0x10, K(A,5));
    I(0x18, K(B,5));
    PATRN(0x0B);
    I(0x00, K(C,6));
    PATRN(0x0C);
    I(0x04, K(D,6)); I(0x0C, K(B,5)); I(0x18, K(G,5));
    PATRN(0x0D);
    I(0x04, K(B,5)); I(0x10, K(G,5)); I(0x18, K(B,5));
    PATRN(0x0E);
    I(0x00, K(A_S,5)); I(0x04, K(F,5)); I(0x08, K(D,6)); I(0x0C, K(F,5));
    I(0x10, K(A_S,5)); I(0x14, K(F,5)); I(0x18, K(D,6)); I(0x1C, K(F,5));
    PATRN(0x0F);
    I(0x00, K(A,5)); I(0x04, K(E,5)); I(0x08, K(C,6)); I(0x0C, K(E,5));
    I(0x10, K(A,5)); I(0x14, K(E,5)); I(0x18, K(C,6)); I(0x1C, K(E,5));
    PATRN(0x10);
    I(0x00, K(G_S,5)); I(0x04, K(D_S,5)); I(0x08, K(C,6)); I(0x0C, K(D_S,5));
    I(0x10, K(G_S,5)); I(0x14, K(D_S,5)); I(0x18, K(C,6)); I(0x1C, K(D_S,5));
    PATRN(0x11);
    I(0x00, K(C,6)); I(0x04, K(A,5)); I(0x08, K(E,6)); I(0x0C, K(A,5));
    I(0x10, K(C,6)); I(0x14, K(A,5)); I(0x18, K(E,6)); I(0x1C, K(A,5));

    P(FM4,0x04,0x00); P(FM4,0x05,0x04); P(FM4,0x06,0x04); P(FM4,0x07,0x05);
    P(FM4,0x08,0x00); P(FM4,0x09,0x06); P(FM4,0x0A,0x07); P(FM4,0x0B,0x06);
    P(FM4,0x0C,0x07); P(FM4,0x0D,0x06); P(FM4,0x0E,0x08); P(FM4,0x0F,0x09);
    P(FM4,0x10,0x0A); P(FM4,0x11,0x0B); P(FM4,0x12,0x0C); P(FM4,0x13,0x0B);
    P(FM4,0x14,0x0D); P(FM4,0x15,0x0B); P(FM4,0x16,0x0C); P(FM4,0x17,0x0B);
    P(FM4,0x18,0x0B); P(FM4,0x19,0x0E); P(FM4,0x1A,0x0E); P(FM4,0x1B,0x0F);
    P(FM4,0x1C,0x0F); P(FM4,0x1D,0x10); P(FM4,0x1E,0x10); P(FM4,0x1F,0x11);
    P(FM4,0x20,0x11);

    VOLM(1.0f);
    CHANL(FM1);
    INSTR(BELL);
    PATRN(0x00);
    I(0x00, K(A,5)); I(0x02, K(F,5));
    I(0x04, K(A,5)); I(0x06, K(F,5));
    I(0x08, K(B,5)); I(0x0A, K(G,5));
    I(0x0C, K(B,5)); I(0x0E, K(G,5));
    I(0x10, K(C,6)); I(0x12, K(A,5));
    I(0x14, K(C,6)); I(0x16, K(A,5));
    I(0x18, K(D,6)); I(0x1A, K(B,5));
    I(0x1C, K(D,6)); I(0x1E, K(B,5));

    PATRN(0x01);
    I(0x00, K(E,6), UI32(0x18FFFFFF));
    VOLM(vE);
    I(0x02, K(C,6), UI32(0x18000000));
    I(0x04, K(E,6), UI32(0x18FFFFFF)); I(0x06, K(C,6), UI32(0x18000000));
    I(0x08, K(E,6), UI32(0x18FFFFFF));
    VOLM(vD);
    I(0x0A, K(C,6), UI32(0x18000000));
    I(0x0C, K(E,6), UI32(0x18FFFFFF)); I(0x0E, K(C,6), UI32(0x18000000));
    I(0x10, K(E,6), UI32(0x18FFFFFF));
    VOLM(vC);
    I(0x12, K(C,6), UI32(0x18000000));
    I(0x14, K(E,6), UI32(0x18FFFFFF)); I(0x16, K(C,6), UI32(0x18000000));
    I(0x18, K(E,6), UI32(0x18FFFFFF));
    VOLM(vB);
    I(0x1A, K(C,6), UI32(0x18000000));
    I(0x1C, K(E,6), UI32(0x18FFFFFF)); I(0x1E, K(C,6), UI32(0x18000000));

    PATRN(0x02);
    I(0x00, K(E,6), UI32(0x18FFFFFF)); I(0x02, K(C,6), UI32(0x18000000));
    I(0x04, K(E,6), UI32(0x18FFFFFF)); I(0x06, K(C,6), UI32(0x18000000));
    I(0x08, K(E,6), UI32(0x18FFFFFF)); I(0x0A, K(C,6), UI32(0x18000000));
    I(0x0C, K(E,6), UI32(0x18FFFFFF)); I(0x0E, K(C,6), UI32(0x18000000));
    I(0x10, K(E,6), UI32(0x18FFFFFF)); I(0x12, K(C,6), UI32(0x18000000));
    I(0x14, K(E,6), UI32(0x18FFFFFF)); R(0x16,  UI32(0x18000000));

    P(FM1, 0x04,0x03); P(FM1, 0x05,0x03); P(FM1, 0x06,0x03); P(FM1, 0x07,0x03); P(FM1, 0x08,0x03);

    VOLM(vF);
    INSTR(LEAD);
    PATRN(0x04);
    I(0x00, leadpitch);
    I(0x10, K(C,6), UI32(0x12000000));
    I(0x14, K(A,5)); I(0x1C, K(C,6));

    PATRN(0x05);
    I(0x00, K(B,5)); I(0x08, K(C,6));
    I(0x0C, K(B,5)); I(0x14, K(G,5));
    I(0x18, UI32(0x124440A8));

    PATRN(0x06);
    I(0x0C, K(A,5), UI32(0x12000000));
    I(0x10, K(E,6));
    I(0x14, K(D,6)); I(0x1C, K(C,6));

    PATRN(0x07);
    I(0x0C, K(A,5), UI32(0x12000000));
    I(0x10, K(A,5));
    I(0x14, K(F,5)); I(0x1C, K(A,5));

    PATRN(0x08);
    I(0x00, K(G,5));
    I(0x08, K(A,5));
    I(0x0C, K(G,5));
    I(0x14, K(C,5));
    I(0x18, UI32(0x124440A8));
    PATRN(0x09);
    I(0x00, K(D,5));
    PATRN(0x0A);
    I(0x14, K(C,5));
    I(0x18, K(D,5));
    I(0x1C, K(E,5));
    PATRN(0x0B);
    I(0x14, K(C,5));
    I(0x18, K(C,5));
    I(0x1C, K(E,5));
    PATRN(0x0C);
    I(0x00, K(D_S,5));
    PATRN(0x0D);
    I(0x14, K(C,5));
    I(0x18, K(D_S,5));
    I(0x1C, K(D,5));
    PATRN(0x0F);
    I(0x00, K(G,5));
    I(0x08, K(A,5));
    I(0x0C, K(G,5));
    I(0x14, K(C,5));
    I(0x18, K(C,5));
    I(0x1C, K(E,5));
    INSTR(ACCOMP);
    PATRN(0x0E);
    I(0x04, K(E,6), accomppitch); I(0x08, K(F,6));
    I(0x0C, K(E,6)); I(0x10, K(G,6));
    I(0x14, K(E,6)); I(0x18, K(E,6));
    I(0x1C, K(C,6)); R(0x1F);

    P(FM1,0x09,0x04); P(FM1,0x0A,0x05); P(FM1,0x0B,0x06);
    P(FM1,0x0C, 0x05); P(FM1, 0x0D,0x04); P(FM1,0x0E,0x05);
    P(FM1, 0x0F, 0x07); P(FM1, 0x10, 0x08);
    P(FM1, 0x11, 0x04); P(FM1, 0x12, 0x05); P(FM1, 0x13, 0x06);
    P(FM1, 0x14, 0x05); P(FM1, 0x15, 0x04); P(FM1, 0x16, 0x05);
    P(FM1, 0x17, 0x07); P(FM1, 0x18, 0x0F);
    P(FM1, 0x19, 0x09); P(FM1, 0x1A, 0x0A);
    P(FM1, 0x1C, 0x0B); P(FM1, 0x1D, 0x0C); P(FM1, 0x1E, 0x0D);
    P(FM1, 0x20, 0x0E);

    CHANL(FM0);
    VOLM(vF);
    INSTR(BASS);
    PATRN(0x00);
    I(0x04, K(A,1), basspitch); I(0x08, K(A,2)); I(0x0C, K(A,1)); I(0x10, K(A_S,1));
    I(0x14, K(A_S,2)); I(0x18, K(B,1)); I(0x1C, K(B,2));
    PATRN(0x01);
    I(0x00, K(C,2)); R(0x02);
    I(0x04, K(C,2)); R(0x06);
    I(0x08, K(C,2)); R(0x0A);
    I(0x0C, K(C,2)); R(0x0E);
    I(0x10, K(C,2)); R(0x12);
    I(0x14, K(C,2)); R(0x16);
    I(0x18, K(C,2)); R(0x1A);
    I(0x1C, K(C,2)); R(0x1E);
    PATRN(0x02);
    I(0x00, K(C,2)); R(0x02); I(0x04, K(C,2));
    I(0x08, K(A,1)); R(0x0A); I(0x0C, K(A,1));
    I(0x10, K(A_S,1)); R(0x12); I(0x14, K(A_S,1));
    I(0x18, K(B,1)); R(0x1A); I(0x1C, K(B,1));
    PATRN(0x03);
    I(0x00, K(C,2)); R(0x02);
    I(0x04, K(C,2)); R(0x06);
    I(0x08, K(C,2)); R(0x0A);
    I(0x0C, K(C,2)); R(0x0E);
    I(0x10, K(C,2)); R(0x12);
    I(0x14, K(C,2));
    I(0x18, K(D,2));
    I(0x1C, K(E,2));
    PATRN(0x04);
    I(0x00, K(F,2)); R(0x02);
    I(0x04, K(F,2)); R(0x06);
    I(0x08, K(F,2)); R(0x0A);
    I(0x0C, K(F,2)); R(0x0E);
    I(0x10, K(F,2)); R(0x12);
    I(0x14, K(F,2)); R(0x16);
    I(0x18, K(F,2)); R(0x1A);
    I(0x1C, K(F,2));
    PATRN(0x05);
    I(0x00, K(E,2)); R(0x02);
    I(0x04, K(E,2)); R(0x06);
    I(0x08, K(E,2)); R(0x0A);
    I(0x0C, K(E,2)); R(0x0E);
    I(0x10, K(E,2)); R(0x12);
    I(0x14, K(C,2));
    I(0x18, K(D,2));
    I(0x1C, K(E,2));
    PATRN(0x06);
    I(0x00, K(E,2)); R(0x02);
    I(0x04, K(E,2)); R(0x06);
    I(0x08, K(E,2)); R(0x0A);
    I(0x0C, K(E,2)); R(0x0E);
    I(0x10, K(E,2)); R(0x12);
    I(0x14, K(E,2)); R(0x16);
    I(0x18, K(E,2)); R(0x1A);
    I(0x1C, K(E,2));
    PATRN(0x07);
    I(0x00, K(D,2)); R(0x02);
    I(0x04, K(D,2)); R(0x06);
    I(0x08, K(D,2)); R(0x0A);
    I(0x0C, K(D,2)); R(0x0E);
    I(0x10, K(D,2)); R(0x12);
    I(0x14, K(D,2)); R(0x16);
    I(0x18, K(D,2)); R(0x1A);
    I(0x1C, K(D,2));
    PATRN(0x08);
    I(0x00,K(A_S,1));
    I(0x0C,K(A,1));
    I(0x18,K(G,1));
    PATRN(0x09);
    I(0x04, K(F,1));
    I(0x10, K(E,1)); R(0x14);
    I(0x18, K(D,1)); R(0x1C);
    PATRN(0x0A);
    I(0x00,K(A,1));
    I(0x0C,K(B,1));
    I(0x18,K(C,2));
    PATRN(0x0B);
    I(0x04, K(D,2));
    I(0x10, K(E,2)); R(0x14);
    I(0x18, K(A,2)); R(0x1C);
    PATRN(0x0C);
    I(0x00,K(G_S,2));
    I(0x0C,K(G,2));
    I(0x18,K(F,2));
    PATRN(0x0D);
    I(0x04, K(D_S,2));
    I(0x10, K(D,2)); R(0x14);
    I(0x18, K(C,2)); R(0x1C);
    PATRN(0x0E);
    I(0x00,K(G,1));
    I(0x0C,K(D,1));
    I(0x18,K(G,1));
    PATRN(0x0F);
    I(0x04,K(G,2));
    I(0x08,K(E,1));
    I(0x0C,K(E,2));
    I(0x10,K(F,1));
    I(0x14,K(F,2));
    I(0x18,K(G,1));
    I(0x1C,K(G,2));

    P(FM0, 0x02, 0x01); P(FM0, 0x03, 0x01); P(FM0, 0x04, 0x02);
    P(FM0, 0x05, 0x01); P(FM0, 0x06, 0x01); P(FM0, 0x07, 0x01);
    P(FM0, 0x08, 0x03); P(FM0, 0x09, 0x04); P(FM0, 0x0A, 0x05);
    P(FM0, 0x0B, 0x04); P(FM0, 0x0C, 0x05); P(FM0, 0x0D, 0x04);
    P(FM0, 0x0E, 0x06); P(FM0, 0x0F, 0x07); P(FM0, 0x10, 0x03);
    P(FM0, 0x11, 0x04); P(FM0, 0x12, 0x05); P(FM0, 0x13, 0x04);
    P(FM0, 0x14, 0x05); P(FM0, 0x15, 0x04); P(FM0, 0x16, 0x06);
    P(FM0, 0x17, 0x07); P(FM0, 0x18, 0x01); P(FM0, 0x19, 0x08);
    P(FM0, 0x1A, 0x09); P(FM0, 0x1B, 0x0A); P(FM0, 0x1C, 0x0B);
    P(FM0, 0x1D, 0x0C); P(FM0, 0x1E, 0x0D); P(FM0, 0x1F, 0x0E);
    P(FM0, 0x20, 0x0F);

    this->setPatterns(patterns);
    this->setPatternsIndices(pattern_indices);
}
